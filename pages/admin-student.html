<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#" onclick="loadPage('admin-dashboard.html')">Dashboard</a></li>
        <li class="breadcrumb-item active" aria-current="page">Students</li>
    </ol>
</nav>

<h2 class="mb-3">Student Master</h2>

<div class="mb-3">
    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addStudentModal">
        <i class="fa fa-plus me-1"></i> Add Student
    </button>
</div>

<div class="table-responsive">
    <table class="table table-bordered align-middle">
        <thead class="table-light">
            <tr>
                <th>Student ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="studentTableBody">

        </tbody>
    </table>
</div>

<div class="modal fade" id="addStudentModal" tabindex="-1" aria-labelledby="addStudentModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="studentForm" novalidate>
                <div class="modal-header">
                    <h5 class="modal-title" id="addStudentModalLabel">Add Student</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">


                    <div class="mb-3">
                        <label for="studentName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="studentName" required>
                        <div class="invalid-feedback">Enter Valid Length </div>
                    </div>

                    <div class="mb-3">
                        <label for="studentEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="studentEmail" required>
                        <div class="invalid-feedback">Enter Valid Email </div>
                    </div>

                    <div class="mb-3">
                        <label for="studentPhone" class="form-label">Phone</label>
                        <input type="tel" class="form-control" id="studentPhone" required>
                        <div class="invalid-feedback">Enter Valid Phone Number </div>
                    </div>

                    <div class="mb-3">
                        <label for="studentPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="studentPassword" required>
                        <div class="invalid-feedback">Enter Valid Password </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-success">Save Student</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    (() => {
        let allStudents = [];
        const apiUrl = "http://localhost:3000";
        const form = document.getElementById("studentForm");

        function fetchAndRenderStudent() {
            fetch(`${apiUrl}/Users`)
                .then(res => res.json())
                .then(users => {
                    allStudents = users.filter(user => user.usertype === "student");
                    renderStudents(allStudents);
                });
        }

        //-------------------------------------------------------

        //--------------------------------------------------------
        function renderStudents(students) {
            const tbody = document.getElementById("studentTableBody");
            tbody.innerHTML = "";

            students.forEach(stud => {
                if (stud.usertype === "student") {
                    const row = document.createElement("tr");
                    row.innerHTML = `
      <td>${stud.id}</td>
      <td>${stud.name}</td>
      <td>${stud.email}</td>
      <td>${stud.phone}</td>
      <td>
        <button class="btn btn-sm btn-warning me-1" data-id="${stud.id}"><i class="fa fa-edit" ></i></button>
        <button class="btn btn-sm btn-danger" data-id="${stud.id}"><i class="fa fa-trash"></i></button>
       
      </td>
    `;
                    tbody.appendChild(row);
                }
            });

            document.querySelectorAll(".btn-warning").forEach(btn => {
                btn.addEventListener("click", () => {
                    const id = btn.getAttribute("data-id");
                    loadStudentForEdit(id);
                });
            });

            document.querySelectorAll(".btn-danger").forEach(btn => {
                btn.addEventListener("click", () => {
                    const id = btn.getAttribute("data-id");
                    deleteStudent(id);
                });
            });

        }
        fetchAndRenderStudent();


    })()
</script>